# 在RK3568平台上进行61850主程序的加密方案

### 1、如果文件系统中没有`openssl`及相关库文件，则需要先安装`openssl`及库：

```sh
./install_openssl.sh
```

### 2、用`sanway_system_dir`目录下的`sanway_system`收集文件系统上的信息：

```sh
./sanway_system
```

> [!note]
>
> 将会生成一个信息文件为：**info.enc**，并且文件为加密文件。
>
> 让客户将**info.enc**寄给我们，我们在用该命令生成解密后的信息文件：
>
> ```sh
> ./sanway_system decode
> ```
>
> 生成明文的文件：**decode.txt**
>
> 注意解密时需要配合**privatekey.pem**，否则无法解密。

### 3、用`iec61850_encode_arm64`生成最终的秘钥文件：**license.txt**

```sh
./iec61850_encode_arm64 mmcblk0p6 eth0
```

如果是在x86的电脑上，则可以运行：
	`./UUID和MAC地址生成秘钥程序_我们自己使用/iec61850_encode_width_uuid_x86`这个程序：
	运行时需要提供decode.txt文件中的blk设备UUID，默认是mmcblk0p6的UUID（举例说明）：
	`b776997b-0e4a-4dd7-a290-bbe7c2f723fe`
	接着提供网卡的MAC地址（举例说明）：
	`B2:F:5B:CA:D4:31`
	此时会生成最终的序列号：
	`0x94, 0x56, 0x31, 0x21, 0xef, 0x44, 0x5e, 0xdd, 0x9d, 0x60, 0xdf, 0x60, 0xef, 0xde, 0xf5, 0x33`

### 4、将序列号复制，并新建文件：license.txt，最后再保存，将这个license.txt文件复制到61850程序的目录下，即可。	

> [!note]	
>
> 1、**MAC地址中如果出现有0x这样的字节的，需要将前面的0去掉，再运行加密程序，否则可以解密就不对**。
> 例如如下MAC地址：
> `B2:0F:5B:CA:D4:31`
> 需要将其转换为：
> `B2:F:5B:CA:D4:31`
> 再运行加密程序，生成最终的**license.txt**文件。
>
> 2、**生成license.txt文件后，还需要将文本文件中最后的换行符0A去掉**。可以用ghex之类的软件打开，再删除最后的换行符：0A。
>
> 3、整个加密的程序目录：[加密程序目录](/home/jason/Nutstore/我的坚果云/git_repo/MD5加密算法_与MAC地址结合加密/)