这个目录下是T536用于电力鸿蒙的内核，是在SWA3568的基础上修改而来：

## 1、修改了内核代码：

```sh
/media/jason/btrfs_disk_M/Develop/allwinner/t536/V1.1/kernel/linux-5.10-origin/fs/proc/version.c
```

和

```sh
/media/jason/btrfs_disk_M/Develop/allwinner/t536/V1.1/kernel/linux-5.10-origin/init/version.c
```

将内核版本号改为：

```c
#define DGRI_RELEASE_VERSION	"5.10.0(1.0.1P)-PEE"
```

## 2、烧写方法：

### 2.1. 烧写内核：

**注意：如果从TF卡启动，则eMMC的设备号为：mmcblk1；如果直接从eMMC启动，则eMMC的设备号为：mmcblk1。**

默认从eMMC直接启动。

```sh
dd if=boot.img of=/dev/mmcblk0p3 bs=1M
```

解压缩内核模块：

```sh
rm -rf /lib/modules/*
tar xzvf lib_modules_t536_20250514.tar.gz -C /lib/modules/
depmod -a
modprobe soc_info
```

### 2.2. 覆盖文件系统：

这一步需要从TF卡启动：

```sh
mount /dev/mmcblk1p5 /mnt
tar xzvf t536-openeuler-dgri-rootfs-armhf-20250513.tar.gz -C /mnt/
umount /mnt
sync
```

重启，从eMMC启动，此时整个系统就修改完成了。

以上方法是假定在TF卡上，还有种方法，可以从TF卡启动后，通过nfs加载并覆盖rootfs文件系统，前提是有nfs服务器：

```sh
/bin/busybox mount -t nfs -o nolock 192.168.1.177:/media/ubuntu16.04/mnt/armhf_linux /mnt
```

登录系统可以查看信息，用户名：sanway，密码：szsw@1929

```sh
dgri:~# uname -a          
Linux dgri 5.10.0(1.0.1P)-PEE #37 SMP PREEMPT Wed May 14 15:02:48 CST 2025 aarch64 GNU/Linux
```

```sh
dgri:~# modprobe soc_info
[ 2274.762345] soc_info: created in /sys/class/dev_info
dgri:~# cat /sys/class/dev_info/soc_info
soc sn:373712120c465532
```

说明此时是在电鸿的文件系统下。

### 2.3. 电鸿测试

将电鸿测试系统：pee-test-pack-arm32hf-20250228.tar.gz通过ftp上传至板卡，注意ftp端口号为：35521。telnet的端口号：35523。

执行：

```sh
tar xzvf pee-test-pack-arm32hf-20250228.tar.gz
dgri:~# cd pee-test-pack
dgri:~/pee-test-pack# ./pee_test.sh 
请选择测试项编号：
1.一致性检测
2.完整性检测
3.合规性检测
4.安全性检测
5.稳定性检测
6.性能检测
7.基础功能检测
8.增值功能检测
a.全量测试
q.退出
```

